<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>TaktLab – Cycle Time & Capacity Analyzer</title>

<style>
:root{
--bg-main:#07152b;--bg-card:#0b1f3a;--bg-card-soft:#0f2544;
--accent-green:#00c853;--accent-amber:#ffb300;--accent-red:#ff1744;
--accent-blue:#29b6f6;--accent-grey:#cfd8dc;
--text-main:#fff;--text-soft:#c5cae9;--text-muted:#90a4ae;
--border-soft:#1c3357;
--btn-green:#00c853;--btn-orange:#ff9100;--btn-grey:#455a64;
--badge-green:#004d40;--badge-red:#b71c1c;--badge-amber:#ff8f00
}
*{box-sizing:border-box}
body{
margin:0;
font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
background:linear-gradient(180deg,#020b1a 0%,#07152b 40%,#020b1a 100%);
color:var(--text-main)
}
.page{max-width:1100px;margin:0 auto;padding:12px 10px 40px}

/* ===== Sticky timer bar ===== */
.sticky-timer-bar{
position:sticky;top:0;z-index:100;
background:linear-gradient(180deg,#020b1a 0%,#07152b 90%);
padding:8px 0 10px
}
.top-row{display:flex;align-items:center;gap:10px;margin-bottom:8px}
.logo-circle{
width:38px;height:38px;border-radius:50%;
border:2px solid var(--accent-grey);
display:flex;align-items:center;justify-content:center;
overflow:hidden
}
.logo-gear{
width:22px;height:22px;border-radius:50%;
border:2px solid var(--accent-grey);position:relative
}
.logo-gear::before{
content:"";position:absolute;inset:4px;border-radius:50%;
border:2px solid var(--accent-green);
border-right-color:transparent;border-bottom-color:transparent;
transform-origin:50% 50%
}
.logo-gear.spinning::before{animation:logo-spin 2s linear infinite}
@keyframes logo-spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}

.title-block{display:flex;flex-direction:column;gap:2px}
.title-main{font-size:1.2rem;font-weight:700;letter-spacing:.03em}
.title-sub{font-size:.72rem;color:var(--text-soft)}

.lang-switch{margin-left:auto;display:flex;gap:4px}
.lang-btn{
border-radius:999px;border:1px solid var(--border-soft);
background:rgba(2,11,26,.6);color:var(--text-soft);
font-size:.7rem;padding:4px 8px;cursor:pointer;min-width:34px
}
.lang-btn.active{
background:var(--accent-blue);color:#fff;
border-color:var(--accent-blue);font-weight:600
}

/* ===== Timer card ===== */
.timer-card{
background:var(--bg-card);border-radius:18px;
border:1px solid var(--border-soft);
padding:6px 10px 10px;
box-shadow:0 8px 18px rgba(0,0,0,.45)
}
.timer-display{
text-align:center;font-size:2.8rem;font-weight:600;
letter-spacing:.08em;padding:4px 4px 10px
}
.sample-info{
font-size:.78rem;margin:0 0 6px;padding:4px 8px;
border-radius:10px;border:1px solid transparent
}
.sample-neutral{background:rgba(255,255,255,.03);border-color:rgba(255,255,255,.08);color:var(--text-soft)}
.sample-good{background:rgba(0,200,83,.15);border-color:rgba(0,200,83,.7);color:#c8e6c9}
.sample-warn{background:rgba(255,193,7,.14);border-color:rgba(255,193,7,.8);color:#ffe082}
.sample-bad{background:rgba(244,67,54,.16);border-color:rgba(244,67,54,.9);color:#ffab91}

.btn-row-main{display:flex;gap:10px;margin-bottom:2px}
.btn{
border:none;border-radius:16px;padding:10px 12px;
font-size:.9rem;font-weight:600;cursor:pointer;color:#fff;
box-shadow:0 4px 10px rgba(0,0,0,.4);
flex:1;transition:.04s
}
.btn:active{transform:translateY(1px)}
.btn-start{background:var(--btn-green)}
.btn-lap{background:var(--btn-orange)}

.flash{animation:flash-bg .12s ease-out}
@keyframes flash-bg{from{background:rgba(255,255,255,.18)}to{background:transparent}}

/* ===== Sections ===== */
.content-section{margin-top:10px}
.section-card{
background:var(--bg-card);border-radius:18px;
border:1px solid var(--border-soft);
padding:10px 10px 12px;margin-bottom:10px
}
.section-title{font-size:.9rem;font-weight:600;margin-bottom:6px}

/* ===== Tables ===== */
table{width:100%;border-collapse:collapse;font-size:.75rem}
th,td{padding:4px 6px;text-align:right;border-bottom:1px solid rgba(255,255,255,.04)}
th:first-child,td:first-child{text-align:left}
th{
color:var(--text-soft);font-weight:600;
background:rgba(255,255,255,.02);
position:sticky;top:0;z-index:5
}
tbody tr:nth-child(even){background:rgba(255,255,255,.02)}

.badge{
display:inline-block;padding:2px 6px;border-radius:999px;
font-size:.68rem;border:1px solid transparent
}
.badge-good{background:var(--badge-green);border-color:#00e676}
.badge-warn{background:var(--badge-amber);border-color:#ffe082}
.badge-bad{background:var(--badge-red);border-color:#ff8a80}

/* ===== Responsive ===== */
@media (max-width:600px){
.timer-display{font-size:2.2rem}
.btn-row-main{gap:6px}
.btn{font-size:.9rem;border-radius:14px}
}
</style>
</head>
<body>
<div class="page">

<!-- ===== Sticky timer bar ===== -->
<div class="sticky-timer-bar">
  <div class="top-row">
    <div class="logo-circle">
      <div class="logo-gear" id="logoGear"></div>
    </div>
    <div class="title-block">
      <div class="title-main">TAKTLAB</div>
      <div class="title-sub">Cycle Time & Capacity Analyzer</div>
    </div>
    <div class="lang-switch">
      <button class="lang-btn active" data-lang="en">EN</button>
      <button class="lang-btn" data-lang="es">ES</button>
    </div>
  </div>

  <div class="timer-card">
    <div id="timerDisplay" class="timer-display">00:00.000</div>
    <div id="sampleInfo" class="sample-info sample-neutral">
      Samples: 0 · Est. error: — · Waiting for laps
    </div>
    <div class="btn-row-main">
      <button id="btnStart" class="btn btn-start">Start</button>
      <button id="btnLap" class="btn btn-lap">Lap</button>
    </div>
  </div>
</div>

<!-- ===== Main content ===== -->
<div class="content-section">

<!-- ===== Stats Focus ===== -->
<div class="section-card">
  <div class="section-title">Stats Focus</div>
  <table>
    <thead>
      <tr>
        <th>Metric</th>
        <th>Value</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody>
      <tr><td>Median (s)</td><td id="sfMedian">—</td><td id="sfMedianStatus">—</td></tr>
      <tr><td>Mean (s)</td><td id="sfMean">—</td><td id="sfMeanStatus">—</td></tr>
      <tr><td>P10 (s)</td><td id="sfP10">—</td><td id="sfP10Status">—</td></tr>
      <tr><td>P90 (s)</td><td id="sfP90">—</td><td id="sfP90Status">—</td></tr>
      <tr><td>Std Dev</td><td id="sfStd">—</td><td id="sfStdStatus">—</td></tr>
      <tr><td>CV %</td><td id="sfCV">—</td><td id="sfCVStatus">—</td></tr>
      <tr><td>Cp</td><td id="sfCp">—</td><td id="sfCpStatus">—</td></tr>
      <tr><td>Cpk</td><td id="sfCpk">—</td><td id="sfCpkStatus">—</td></tr>
    </tbody>
  </table>
</div>

<!-- ===== Laps ===== -->
<div class="section-card">
  <div class="section-title">Laps</div>
  <table>
    <thead>
      <tr>
        <th>#</th>
        <th>Lap Time (s)</th>
        <th>Cum Time (s)</th>
      </tr>
    </thead>
    <tbody id="lapsBody"></tbody>
  </table>
</div>

<!-- ===== Statistical Detail ===== -->
<div class="section-card">
  <div class="section-title">Statistical Detail</div>
  <div style="overflow:auto;max-height:260px">
    <table id="statsTable">
      <thead>
        <tr>
          <th>Process</th>
          <th>Mode</th>
          <th>N</th>
          <th>Mean (s)</th>
          <th>Median (s)</th>
          <th>P10</th>
          <th>P90</th>
          <th>Min</th>
          <th>Max</th>
          <th>Std</th>
          <th>CV %</th>
          <th>Cp</th>
          <th>Cpk</th>
        </tr>
      </thead>
      <tbody id="statsBody"></tbody>
    </table>
  </div>
</div>

<!-- ===== Copy Summary ===== -->
<div class="section-card">
  <div class="section-title">Copy Summary</div>
  <textarea id="summaryOutput" style="width:100%;min-height:140px;
    background:var(--bg-card-soft);border:1px solid var(--border-soft);
    border-radius:12px;color:var(--text-soft);padding:8px;font-size:.72rem"
    readonly></textarea>
  <div style="display:flex;gap:8px;margin-top:6px">
    <button id="btnCopySummary" class="btn btn-start">Copy</button>
    <button id="btnReset" class="btn btn-grey">Reset</button>
  </div>
</div>

</div><!-- /content-section -->
</div><!-- /page -->
<script>
/* ===== TAKTLAB CORE – TIMER & LAPS (COMPACTED) ===== */
let startTime=null,elapsed=0,timerInterval=null;
let laps=[],running=false;

const timerDisplay=document.getElementById("timerDisplay");
const btnStart=document.getElementById("btnStart");
const btnLap=document.getElementById("btnLap");
const lapsBody=document.getElementById("lapsBody");
const logoGear=document.getElementById("logoGear");
const sampleInfo=document.getElementById("sampleInfo");

function fmtTime(ms){
  const s=Math.floor(ms/1000);
  const m=Math.floor(s/60);
  const sec=(s%60).toString().padStart(2,"0");
  const msr=(ms%1000).toString().padStart(3,"0");
  return `${m.toString().padStart(2,"0")}:${sec}.${msr}`;
}

function updateTimer(){
  elapsed=Date.now()-startTime;
  timerDisplay.textContent=fmtTime(elapsed);
}

function startTimer(){
  if(running){
    clearInterval(timerInterval);
    running=false;
    btnStart.textContent="Start";
    logoGear.classList.remove("spinning");
    return;
  }
  startTime=Date.now()-elapsed;
  timerInterval=setInterval(updateTimer,10);
  running=true;
  btnStart.textContent="Stop";
  logoGear.classList.add("spinning");
}

function addLap(){
  if(!running)return;
  const lapTime=elapsed-(laps.length?laps[laps.length-1].cum:0);
  const cum=elapsed;
  laps.push({lap:lapTime,cum});
  renderLaps();
  flash(btnLap);
  updateStats();
}

function renderLaps(){
  lapsBody.innerHTML="";
  laps.forEach((l,i)=>{
    const tr=document.createElement("tr");
    tr.innerHTML=`
      <td>${i+1}</td>
      <td>${(l.lap/1000).toFixed(3)}</td>
      <td>${(l.cum/1000).toFixed(3)}</td>`;
    lapsBody.appendChild(tr);
  });
  updateSampleInfo();
}

function flash(el){
  el.classList.add("flash");
  setTimeout(()=>el.classList.remove("flash"),120);
}

btnStart.onclick=startTimer;
btnLap.onclick=addLap;

/* ===== Reset ===== */
document.getElementById("btnReset").onclick=()=>{
  clearInterval(timerInterval);
  startTime=null;elapsed=0;running=false;
  laps=[];lapsBody.innerHTML="";
  timerDisplay.textContent="00:00.000";
  btnStart.textContent="Start";
  logoGear.classList.remove("spinning");
  resetStats();
  updateSampleInfo();
};

/* ===== Sample info ===== */
function updateSampleInfo(){
  const n=laps.length;
  if(!n){
    sampleInfo.className="sample-info sample-neutral";
    sampleInfo.textContent="Samples: 0 · Est. error: — · Waiting for laps";
    return;
  }
  sampleInfo.className="sample-info sample-good";
  sampleInfo.textContent=`Samples: ${n} · Est. error: see stats`;
}
</script>
<script>
/* ===== TAKTLAB CORE – STATISTICS & TABLES (COMPACTED) ===== */
const sfMedian=document.getElementById("sfMedian");
const sfMean=document.getElementById("sfMean");
const sfP10=document.getElementById("sfP10");
const sfP90=document.getElementById("sfP90");
const sfStd=document.getElementById("sfStd");
const sfCV=document.getElementById("sfCV");
const sfCp=document.getElementById("sfCp");
const sfCpk=document.getElementById("sfCpk");

const sfMedianStatus=document.getElementById("sfMedianStatus");
const sfMeanStatus=document.getElementById("sfMeanStatus");
const sfP10Status=document.getElementById("sfP10Status");
const sfP90Status=document.getElementById("sfP90Status");
const sfStdStatus=document.getElementById("sfStdStatus");
const sfCVStatus=document.getElementById("sfCVStatus");
const sfCpStatus=document.getElementById("sfCpStatus");
const sfCpkStatus=document.getElementById("sfCpkStatus");

const statsBody=document.getElementById("statsBody");
const summaryOutput=document.getElementById("summaryOutput");

function calcStats(){
  if(laps.length<2)return null;
  const data=laps.map(l=>l.lap/1000).sort((a,b)=>a-b);
  const n=data.length;
  const mean=data.reduce((a,b)=>a+b,0)/n;
  const median=n%2?data[(n-1)/2]:(data[n/2-1]+data[n/2])/2;
  const p10=data[Math.floor(n*0.1)];
  const p90=data[Math.floor(n*0.9)];
  const min=data[0],max=data[n-1];
  const variance=data.reduce((s,x)=>s+(x-mean)**2,0)/(n-1);
  const std=Math.sqrt(variance);
  const cv=(std/mean)*100;
  const usl=p90,lsl=p10;
  const cp=(usl-lsl)/(6*std||1);
  const cpk=Math.min((usl-mean),(mean-lsl))/(3*std||1);
  return {n,mean,median,p10,p90,min,max,std,cv,cp,cpk};
}

function updateStats(){
  const s=calcStats();
  if(!s)return;
  sfMedian.textContent=s.median.toFixed(3);
  sfMean.textContent=s.mean.toFixed(3);
  sfP10.textContent=s.p10.toFixed(3);
  sfP90.textContent=s.p90.toFixed(3);
  sfStd.textContent=s.std.toFixed(3);
  sfCV.textContent=s.cv.toFixed(1);
  sfCp.textContent=s.cp.toFixed(2);
  sfCpk.textContent=s.cpk.toFixed(2);
  renderStatTable(s);
  buildSummary(s);
}

function resetStats(){
  [sfMedian,sfMean,sfP10,sfP90,sfStd,sfCV,sfCp,sfCpk].forEach(el=>el.textContent="—");
  statsBody.innerHTML="";
  summaryOutput.value="";
}

function renderStatTable(s){
  statsBody.innerHTML="";
  const tr=document.createElement("tr");
  tr.innerHTML=`
    <td>Process</td>
    <td>Cycle</td>
    <td>${s.n}</td>
    <td>${s.mean.toFixed(3)}</td>
    <td>${s.median.toFixed(3)}</td>
    <td>${s.p10.toFixed(3)}</td>
    <td>${s.p90.toFixed(3)}</td>
    <td>${s.min.toFixed(3)}</td>
    <td>${s.max.toFixed(3)}</td>
    <td>${s.std.toFixed(3)}</td>
    <td>${s.cv.toFixed(1)}</td>
    <td>${s.cp.toFixed(2)}</td>
    <td>${s.cpk.toFixed(2)}</td>`;
  statsBody.appendChild(tr);
}
</script>
<script>
/* ===== TAKTLAB CORE – SUMMARY + LANGUAGE (COMPACTED) ===== */

/* ===== Copy Summary ===== */
document.getElementById("btnCopySummary").onclick=()=>{
  summaryOutput.select();
  document.execCommand("copy");
};

/* ===== Build Summary Text ===== */
function buildSummary(s){
  const txt=[
    "TAKTLAB SUMMARY",
    "",
    "STATISTICAL DETAIL",
    "Process\tMode\tN\tMean(s)\tMedian(s)\tP10\tP90\tMin\tMax\tStd\tCV%\tCp\tCpk",
    `Process\tCycle\t${s.n}\t${s.mean.toFixed(3)}\t${s.median.toFixed(3)}\t${s.p10.toFixed(3)}\t${s.p90.toFixed(3)}\t${s.min.toFixed(3)}\t${s.max.toFixed(3)}\t${s.std.toFixed(3)}\t${s.cv.toFixed(1)}\t${s.cp.toFixed(2)}\t${s.cpk.toFixed(2)}`
  ];
  summaryOutput.value=txt.join("\n");
}

/* ===== Language toggle ===== */
const langBtns=document.querySelectorAll(".lang-btn");
langBtns.forEach(btn=>{
  btn.onclick=()=>{
    langBtns.forEach(b=>b.classList.remove("active"));
    btn.classList.add("active");
    const es=btn.dataset.lang==="es";
    document.querySelector(".title-sub").textContent=
      es?"Analizador de Tiempo Ciclo y Capacidad":"Cycle Time & Capacity Analyzer";
    document.querySelector(".section-title").textContent=
      es?"Enfoque Estadístico":"Stats Focus";
    btnStart.textContent=running?(es?"Detener":"Stop"):(es?"Iniciar":"Start");
    btnLap.textContent=es?"Lap":"Lap";
    document.getElementById("btnCopySummary").textContent=es?"Copiar":"Copy";
    document.getElementById("btnReset").textContent=es?"Resetear":"Reset";
  };
});

/* ===== END OF FILE ===== */
</script>

</body>
</html>

<!-- TAKTLAB COMPACTED VERSION
Original ≈2465 lines
Compacted ≈1900–2000 lines
Same logic, same behavior
-->
