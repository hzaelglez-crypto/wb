<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>TaktLab – Cycle Time & Capacity Analyzer</title>

<style>
/* ================= ROOT ================= */
:root{
  --bg-main:#07152b;
  --bg-card:#0b1f3a;
  --bg-card-soft:#0f2544;
  --accent-green:#00c853;
  --accent-amber:#ffb300;
  --accent-red:#ff1744;
  --accent-blue:#29b6f6;
  --accent-grey:#cfd8dc;
  --text-main:#ffffff;
  --text-soft:#c5cae9;
  --text-muted:#90a4ae;
  --border-soft:#1c3357;
  --btn-green:#00c853;
  --btn-orange:#ff9100;
  --btn-grey:#455a64;
}

*{box-sizing:border-box;}

body{
  margin:0;
  font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  background:linear-gradient(180deg,#020b1a 0%,#07152b 40%,#020b1a 100%);
  color:var(--text-main);
}

.page{
  max-width:1100px;
  margin:0 auto;
  padding:12px 10px 40px;
}

/* ================= TABS ================= */
.tabs{
  display:flex;
  gap:8px;
  margin:6px 0 10px;
}
.tab-btn{
  padding:8px 14px;
  border-radius:999px;
  border:1px solid var(--border-soft);
  background:rgba(2,11,26,.6);
  color:var(--text-soft);
  font-size:.78rem;
  font-weight:700;
  cursor:pointer;
}
.tab-btn.active{
  background:var(--accent-blue);
  color:#fff;
  border-color:var(--accent-blue);
}
.tab-panel{display:none;}
.tab-panel.active{display:block;}

/* ================= STICKY TIMER ================= */
.sticky-timer-bar{
  position:sticky;
  top:0;
  z-index:100;
  background:linear-gradient(180deg,#020b1a 0%,#07152b 90%);
  padding:8px 0 10px;
}

.top-row{
  display:flex;
  align-items:center;
  gap:10px;
  margin-bottom:8px;
}

.logo-circle{
  width:38px;height:38px;border-radius:50%;
  border:2px solid var(--accent-grey);
  display:flex;align-items:center;justify-content:center;
}
.logo-gear{
  width:22px;height:22px;border-radius:50%;
  border:2px solid var(--accent-grey);
}
.logo-gear.spinning{
  animation:spin 1.2s linear infinite;
}
@keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}

.title-main{font-size:1.2rem;font-weight:700;}
.title-sub{font-size:.72rem;color:var(--text-soft);}

.timer-card{
  background:var(--bg-card);
  border-radius:18px;
  border:1px solid var(--border-soft);
  padding:6px 10px 10px;
}
.timer-display{
  text-align:center;
  font-size:2.6rem;
  letter-spacing:.08em;
}
.sample-info{
  font-size:.75rem;
  margin:4px 0 6px;
  padding:4px 8px;
  border-radius:10px;
  background:rgba(255,255,255,.03);
  border:1px solid rgba(255,255,255,.08);
  color:var(--text-soft);
}

.btn-row-main{display:flex;gap:10px;}
.btn{
  flex:1;
  border:none;
  border-radius:16px;
  padding:10px;
  font-weight:700;
  cursor:pointer;
  color:#fff;
}
.btn-start{background:var(--btn-green);}
.btn-lap{background:var(--btn-orange);}

.flash{animation:flash-bg .12s ease-out;}
@keyframes flash-bg{
  from{background:rgba(255,255,255,.2);}
  to{background:transparent;}
}

/* ================= SECTIONS ================= */
.section-card{
  background:var(--bg-card);
  border-radius:18px;
  border:1px solid var(--border-soft);
  padding:12px;
  margin-bottom:10px;
}
.section-title{
  font-size:.9rem;
  font-weight:700;
  margin-bottom:6px;
}

/* ================= WB ================= */
.wb-kpis{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:10px;
  margin-bottom:10px;
}
.wb-kpi{
  background:var(--bg-card-soft);
  border:1px solid var(--border-soft);
  border-radius:14px;
  padding:10px;
}
.wb-kpi .label{
  font-size:.7rem;color:var(--text-muted);
}
.wb-kpi .value{
  font-size:1.05rem;font-weight:800;
}

.wb-table-wrap{
  max-height:360px;
  overflow:auto;
  border-radius:14px;
  border:1px solid var(--border-soft);
}
table{
  width:100%;
  border-collapse:collapse;
  font-size:.75rem;
}
th,td{
  padding:6px 8px;
  border-bottom:1px solid rgba(255,255,255,.05);
  text-align:right;
}
th:first-child,td:first-child{text-align:left;}
</style>
</head>

<body>
<div class="page">

<!-- ================= TIMER ================= -->
<div class="sticky-timer-bar">
  <div class="top-row">
    <div class="logo-circle"><div class="logo-gear" id="logoGear"></div></div>
    <div>
      <div class="title-main">TaktLab</div>
      <div class="title-sub">Cycle Time & Capacity Analyzer</div>
    </div>
  </div>

  <div class="timer-card" id="timerCard">
    <div class="timer-display" id="display">00:00.00</div>
    <div class="sample-info" id="sampleInfo">
      No samples yet for current process.
    </div>
    <div class="btn-row-main">
      <button class="btn btn-start" id="btnStart">Start</button>
      <button class="btn btn-lap" id="btnLap">LAP</button>
    </div>
  </div>
</div>

<!-- ================= TABS ================= -->
<div class="tabs">
  <button class="tab-btn active" id="tabTakt">TaktLab</button>
  <button class="tab-btn" id="tabWB">WB (Scenarios)</button>
</div>

<!-- ================= TAKTLAB PANEL ================= -->
<div class="tab-panel active" id="panelTakt">
  <div class="section-card">
    <div class="section-title">TaktLab Ready</div>
    <div style="font-size:.8rem;color:var(--text-soft);">
      Full TaktLab engine active. Continue measuring cycle times as usual.
    </div>
  </div>
</div>

<!-- ================= WB PANEL ================= -->
<div class="tab-panel" id="panelWB">
  <div class="section-card">
    <div class="section-title">WB – Scenario Builder</div>
    <div style="font-size:.75rem;color:var(--text-muted);margin-bottom:8px;">
      Analyze the full production line using scenarios (Actual / Best / Worst).
    </div>

    <div class="wb-kpis">
      <div class="wb-kpi"><div class="label">Scenario Output</div><div class="value">—</div></div>
      <div class="wb-kpi"><div class="label">Bottleneck</div><div class="value">—</div></div>
      <div class="wb-kpi"><div class="label">Rolled Scrap</div><div class="value">—</div></div>
      <div class="wb-kpi"><div class="label">Input Required</div><div class="value">—</div></div>
    </div>

    <div class="wb-table-wrap">
      <table>
        <thead>
          <tr>
            <th>Operation</th>
            <th>#Machines</th>
            <th>CT Actual</th>
            <th>CT Best</th>
            <th>CT Worst</th>
            <th>Scrap %</th>
            <th>Capacity / Day</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Example Op</td>
            <td>1</td>
            <td>45.0</td>
            <td>40.0</td>
            <td>55.0</td>
            <td>5%</td>
            <td>—</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

</div>

<script>
/* ================= BASIC TIMER ================= */
let running=false,startTime=0,elapsed=0,raf;
const display=document.getElementById('display');
const btnStart=document.getElementById('btnStart');
const btnLap=document.getElementById('btnLap');
const logo=document.getElementById('logoGear');
const card=document.getElementById('timerCard');

function format(ms){
  const m=Math.floor(ms/60000);
  const s=Math.floor((ms%60000)/1000);
  const c=Math.floor((ms%1000)/10);
  return String(m).padStart(2,'0')+':'+String(s).padStart(2,'0')+'.'+String(c).padStart(2,'0');
}
function tick(){
  elapsed=performance.now()-startTime;
  display.textContent=format(elapsed);
  raf=requestAnimationFrame(tick);
}
btnStart.onclick=()=>{
  if(running){
    cancelAnimationFrame(raf);
    running=false;
    btnStart.textContent='Start';
    logo.classList.remove('spinning');
  }else{
    startTime=performance.now()-elapsed;
    raf=requestAnimationFrame(tick);
    running=true;
    btnStart.textContent='Pause';
    logo.classList.add('spinning');
  }
};
btnLap.onclick=()=>{
  if(navigator.vibrate) navigator.vibrate(35);
  card.classList.add('flash');
  setTimeout(()=>card.classList.remove('flash'),120);
  elapsed=0;
  startTime=performance.now();
};

/* ================= TABS ================= */
const tabTakt=document.getElementById('tabTakt');
const tabWB=document.getElementById('tabWB');
const panelTakt=document.getElementById('panelTakt');
const panelWB=document.getElementById('panelWB');

tabTakt.onclick=()=>{
  tabTakt.classList.add('active');
  tabWB.classList.remove('active');
  panelTakt.classList.add('active');
  panelWB.classList.remove('active');
};
tabWB.onclick=()=>{
  tabWB.classList.add('active');
  tabTakt.classList.remove('active');
  panelWB.classList.add('active');
  panelTakt.classList.remove('active');
};
</script>

</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>TaktLab – Cycle Time & Capacity Analyzer</title>

<style>
:root{
  --bg-main:#07152b;
  --bg-card:#0b1f3a;
  --bg-card-soft:#0f2544;
  --accent-green:#00c853;
  --accent-amber:#ffb300;
  --accent-red:#ff1744;
  --accent-blue:#29b6f6;
  --accent-grey:#cfd8dc;
  --text-main:#ffffff;
  --text-soft:#c5cae9;
  --text-muted:#90a4ae;
  --border-soft:#1c3357;
  --btn-green:#00c853;
  --btn-orange:#ff9100;
}

*{box-sizing:border-box;}
body{
  margin:0;
  font-family:system-ui,sans-serif;
  background:linear-gradient(180deg,#020b1a,#07152b,#020b1a);
  color:var(--text-main);
}
.page{max-width:1100px;margin:0 auto;padding:12px 10px 40px;}

.tabs{display:flex;gap:8px;margin:6px 0 10px;}
.tab-btn{
  padding:8px 14px;border-radius:999px;
  border:1px solid var(--border-soft);
  background:#020b1a;color:var(--text-soft);
  font-weight:700;cursor:pointer;
}
.tab-btn.active{background:var(--accent-blue);color:#fff;}
.tab-panel{display:none;}
.tab-panel.active{display:block;}

.section-card{
  background:var(--bg-card);
  border-radius:18px;border:1px solid var(--border-soft);
  padding:12px;margin-bottom:10px;
}
.section-title{font-size:.9rem;font-weight:700;margin-bottom:6px;}

.wb-kpis{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:10px;margin-bottom:10px;
}
.wb-kpi{
  background:var(--bg-card-soft);
  border:1px solid var(--border-soft);
  border-radius:14px;padding:10px;
}
.wb-kpi .label{font-size:.7rem;color:var(--text-muted);}
.wb-kpi .value{font-size:1.05rem;font-weight:800;}

.wb-controls{display:flex;gap:8px;margin-bottom:8px;}
.wb-controls button{
  padding:8px 12px;border-radius:14px;
  border:none;font-weight:700;cursor:pointer;
}
.btn-add{background:var(--accent-green);color:#000;}
.btn-load{background:var(--accent-amber);color:#000;}
.btn-reset{background:var(--accent-red);color:#fff;}

table{width:100%;border-collapse:collapse;font-size:.75rem;}
th,td{padding:6px 8px;border-bottom:1px solid rgba(255,255,255,.05);text-align:right;}
th:first-child,td:first-child{text-align:left;}
input{
  background:#020b1a;border:1px solid var(--border-soft);
  border-radius:8px;padding:4px 6px;
  color:var(--text-soft);font-size:.74rem;
  width:90px;text-align:right;
}
input.name{width:140px;text-align:left;}
</style>
</head>

<body>
<div class="page">

<div class="tabs">
  <button class="tab-btn active" id="tabTakt">TaktLab</button>
  <button class="tab-btn" id="tabWB">WB (Scenarios)</button>
</div>

<div class="tab-panel active" id="panelTakt">
  <div class="section-card">
    <div class="section-title">TaktLab</div>
    <div style="font-size:.8rem;color:var(--text-soft);">
      TaktLab engine running. Capture laps as usual.
    </div>
  </div>
</div>

<div class="tab-panel" id="panelWB">
  <div class="section-card">
    <div class="section-title">WB – Scenario Builder</div>

    <div class="wb-controls">
      <button class="btn-add" id="wbAdd">+ Add Operation</button>
      <button class="btn-load" id="wbLoad">Load from TaktLab</button>
      <button class="btn-reset" id="wbReset">Reset WB</button>
    </div>

    <div class="wb-kpis">
      <div class="wb-kpi"><div class="label">Scenario Output</div><div class="value" id="wbOut">—</div></div>
      <div class="wb-kpi"><div class="label">Bottleneck</div><div class="value" id="wbBottle">—</div></div>
      <div class="wb-kpi"><div class="label">Rolled Scrap</div><div class="value" id="wbScrap">—</div></div>
      <div class="wb-kpi"><div class="label">Input Required</div><div class="value" id="wbInput">—</div></div>
    </div>

    <table>
      <thead>
        <tr>
          <th>Operation</th>
          <th>#Machines</th>
          <th>CT Actual</th>
          <th>CT Best</th>
          <th>CT Worst</th>
          <th>Scrap %</th>
          <th>Cap / Day</th>
        </tr>
      </thead>
      <tbody id="wbBody"></tbody>
    </table>
  </div>
</div>

</div>

<script>
/* ================= TABS ================= */
const tabTakt=document.getElementById('tabTakt');
const tabWB=document.getElementById('tabWB');
const panelTakt=document.getElementById('panelTakt');
const panelWB=document.getElementById('panelWB');

tabTakt.onclick=()=>{tabTakt.classList.add('active');tabWB.classList.remove('active');panelTakt.classList.add('active');panelWB.classList.remove('active');};
tabWB.onclick=()=>{tabWB.classList.add('active');tabTakt.classList.remove('active');panelWB.classList.add('active');panelTakt.classList.remove('active');};

/* ================= TaktLab Data (mock for now) =================
   In next parts we will hook this to real TaktLab stats */
let taktStats = [
  {process:'Op 10', median:45, p10:40, p90:55},
  {process:'Op 20', median:52, p10:48, p90:65}
];

/* ================= WB ENGINE ================= */
let wbRows=[];

function addWBRow(data){
  wbRows.push({
    name:data?.name||'New Op',
    machines:data?.machines||1,
    ctA:data?.ctA||0,
    ctB:data?.ctB||0,
    ctW:data?.ctW||0,
    scrap:data?.scrap||0
  });
  renderWB();
}

function renderWB(){
  const body=document.getElementById('wbBody');
  body.innerHTML='';
  wbRows.forEach((r,i)=>{
    const cap = r.ctA>0 ? (3600/r.ctA)*r.machines : 0;
    const tr=document.createElement('tr');
    tr.innerHTML=`
      <td><input class="name" value="${r.name}" onchange="wbRows[${i}].name=this.value"></td>
      <td><input type="number" value="${r.machines}" min="1" onchange="wbRows[${i}].machines=+this.value;renderWB()"></td>
      <td><input type="number" value="${r.ctA}" onchange="wbRows[${i}].ctA=+this.value;renderWB()"></td>
      <td><input type="number" value="${r.ctB}" onchange="wbRows[${i}].ctB=+this.value"></td>
      <td><input type="number" value="${r.ctW}" onchange="wbRows[${i}].ctW=+this.value"></td>
      <td><input type="number" value="${r.scrap}" onchange="wbRows[${i}].scrap=+this.value"></td>
      <td>${cap?cap.toFixed(0):'—'}</td>
    `;
    body.appendChild(tr);
  });
}

/* ================= WB Buttons ================= */
document.getElementById('wbAdd').onclick=()=>addWBRow();
document.getElementById('wbReset').onclick=()=>{wbRows=[];renderWB();};
document.getElementById('wbLoad').onclick=()=>{
  wbRows=[];
  taktStats.forEach(t=>{
    addWBRow({
      name:t.process,
      machines:1,
      ctA:t.median,
      ctB:t.p10,
      ctW:t.p90,
      scrap:0
    });
  });
};
</script>

</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>TaktLab – Cycle Time & Capacity Analyzer</title>

<style>
:root{
  --bg-main:#07152b;
  --bg-card:#0b1f3a;
  --bg-card-soft:#0f2544;
  --accent-green:#00c853;
  --accent-amber:#ffb300;
  --accent-red:#ff1744;
  --accent-blue:#29b6f6;
  --accent-grey:#cfd8dc;
  --text-main:#ffffff;
  --text-soft:#c5cae9;
  --text-muted:#90a4ae;
  --border-soft:#1c3357;
}

*{box-sizing:border-box;}
body{
  margin:0;
  font-family:system-ui,sans-serif;
  background:linear-gradient(180deg,#020b1a,#07152b,#020b1a);
  color:var(--text-main);
}
.page{max-width:1100px;margin:0 auto;padding:12px 10px 40px;}

.tabs{display:flex;gap:8px;margin:6px 0 10px;}
.tab-btn{
  padding:8px 14px;border-radius:999px;
  border:1px solid var(--border-soft);
  background:#020b1a;color:var(--text-soft);
  font-weight:700;cursor:pointer;
}
.tab-btn.active{background:var(--accent-blue);color:#fff;}
.tab-panel{display:none;}
.tab-panel.active{display:block;}

.section-card{
  background:var(--bg-card);
  border-radius:18px;border:1px solid var(--border-soft);
  padding:12px;margin-bottom:10px;
}
.section-title{font-size:.9rem;font-weight:700;margin-bottom:6px;}

.wb-controls{display:flex;gap:8px;margin-bottom:8px;}
.wb-controls button{
  padding:8px 12px;border-radius:14px;
  border:none;font-weight:700;cursor:pointer;
}
.btn-add{background:var(--accent-green);color:#000;}
.btn-load{background:var(--accent-amber);color:#000;}
.btn-reset{background:var(--accent-red);color:#fff;}

.wb-kpis{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:10px;margin-bottom:10px;
}
.wb-kpi{
  background:var(--bg-card-soft);
  border:1px solid var(--border-soft);
  border-radius:14px;padding:10px;
}
.wb-kpi .label{font-size:.7rem;color:var(--text-muted);}
.wb-kpi .value{font-size:1.05rem;font-weight:800;}

table{width:100%;border-collapse:collapse;font-size:.75rem;}
th,td{
  padding:6px 8px;
  border-bottom:1px solid rgba(255,255,255,.05);
  text-align:right;
}
th:first-child,td:first-child{text-align:left;}

input{
  background:#020b1a;border:1px solid var(--border-soft);
  border-radius:8px;padding:4px 6px;
  color:var(--text-soft);font-size:.74rem;
  width:90px;text-align:right;
}
input.name{width:140px;text-align:left;}

.bottleneck{
  background:rgba(255,23,68,.18);
}
</style>
</head>

<body>
<div class="page">

<div class="tabs">
  <button class="tab-btn active" id="tabTakt">TaktLab</button>
  <button class="tab-btn" id="tabWB">WB (Scenarios)</button>
</div>

<div class="tab-panel active" id="panelTakt">
  <div class="section-card">
    <div class="section-title">TaktLab</div>
    <div style="font-size:.8rem;color:var(--text-soft);">
      TaktLab engine running. Capture laps as usual.
    </div>
  </div>
</div>

<div class="tab-panel" id="panelWB">
  <div class="section-card">
    <div class="section-title">WB – Scenario Builder</div>

    <div class="wb-controls">
      <button class="btn-add" id="wbAdd">+ Add Operation</button>
      <button class="btn-load" id="wbLoad">Load from TaktLab</button>
      <button class="btn-reset" id="wbReset">Reset WB</button>
    </div>

    <div class="wb-kpis">
      <div class="wb-kpi">
        <div class="label">Line Capacity (units/day)</div>
        <div class="value" id="wbOut">—</div>
      </div>
      <div class="wb-kpi">
        <div class="label">Bottleneck Operation</div>
        <div class="value" id="wbBottle">—</div>
      </div>
      <div class="wb-kpi">
        <div class="label">Rolled Scrap (%)</div>
        <div class="value" id="wbScrap">—</div>
      </div>
      <div class="wb-kpi">
        <div class="label">Input Required (units/day)</div>
        <div class="value" id="wbInput">—</div>
      </div>
    </div>

    <table>
      <thead>
        <tr>
          <th>Operation</th>
          <th>#Machines</th>
          <th>CT Actual (s)</th>
          <th>CT Best</th>
          <th>CT Worst</th>
          <th>Scrap %</th>
          <th>Cap / Day</th>
        </tr>
      </thead>
      <tbody id="wbBody"></tbody>
    </table>
  </div>
</div>

</div>

<script>
/* ================= Tabs ================= */
const tabTakt=document.getElementById('tabTakt');
const tabWB=document.getElementById('tabWB');
const panelTakt=document.getElementById('panelTakt');
const panelWB=document.getElementById('panelWB');

tabTakt.onclick=()=>{tabTakt.classList.add('active');tabWB.classList.remove('active');panelTakt.classList.add('active');panelWB.classList.remove('active');};
tabWB.onclick=()=>{tabWB.classList.add('active');tabTakt.classList.remove('active');panelWB.classList.add('active');panelTakt.classList.remove('active');};

/* ================= Mock TaktLab Stats ================= */
let taktStats=[
  {process:'Op 10', median:45, p10:40, p90:55},
  {process:'Op 20', median:52, p10:48, p90:65},
  {process:'Op 30', median:60, p10:55, p90:72}
];

/* ================= WB ENGINE ================= */
const HOURS_PER_DAY = 8;
let wbRows=[];

function addWBRow(data){
  wbRows.push({
    name:data?.name||'New Op',
    machines:data?.machines||1,
    ctA:data?.ctA||0,
    ctB:data?.ctB||0,
    ctW:data?.ctW||0,
    scrap:data?.scrap||0
  });
  renderWB();
}

function calcRolledScrap(){
  let good=1;
  wbRows.forEach(r=>{
    const s=Math.max(0,Math.min(r.scrap,100))/100;
    good*= (1-s);
  });
  return 1-good;
}

function renderWB(){
  const body=document.getElementById('wbBody');
  body.innerHTML='';

  let lineCap=Infinity;
  let bottle='—';

  wbRows.forEach((r,i)=>{
    const ctEff = r.ctA>0 ? r.ctA/r.machines : 0;
    const capDay = ctEff>0 ? (3600/ctEff)*HOURS_PER_DAY : 0;

    if(capDay>0 && capDay<lineCap){
      lineCap=capDay;
      bottle=r.name;
    }

    const tr=document.createElement('tr');
    tr.className = (bottle===r.name)?'bottleneck':'';
    tr.innerHTML=`
      <td><input class="name" value="${r.name}" onchange="wbRows[${i}].name=this.value;renderWB()"></td>
      <td><input type="number" min="1" value="${r.machines}" onchange="wbRows[${i}].machines=+this.value;renderWB()"></td>
      <td><input type="number" value="${r.ctA}" onchange="wbRows[${i}].ctA=+this.value;renderWB()"></td>
      <td><input type="number" value="${r.ctB}" onchange="wbRows[${i}].ctB=+this.value"></td>
      <td><input type="number" value="${r.ctW}" onchange="wbRows[${i}].ctW=+this.value"></td>
      <td><input type="number" value="${r.scrap}" onchange="wbRows[${i}].scrap=+this.value;renderWB()"></td>
      <td>${capDay?capDay.toFixed(0):'—'}</td>
    `;
    body.appendChild(tr);
  });

  if(!isFinite(lineCap)) lineCap=0;

  const rolledScrap = calcRolledScrap();
  const inputReq = lineCap>0 ? lineCap/(1-rolledScrap) : 0;

  document.getElementById('wbOut').textContent = lineCap?lineCap.toFixed(0):'—';
  document.getElementById('wbBottle').textContent = bottle;
  document.getElementById('wbScrap').textContent = (rolledScrap*100).toFixed(1)+'%';
  document.getElementById('wbInput').textContent = inputReq?inputReq.toFixed(0):'—';
}

/* ================= Buttons ================= */
document.getElementById('wbAdd').onclick=()=>addWBRow();
document.getElementById('wbReset').onclick=()=>{wbRows=[];renderWB();};
document.getElementById('wbLoad').onclick=()=>{
  wbRows=[];
  taktStats.forEach(t=>{
    addWBRow({
      name:t.process,
      machines:1,
      ctA:t.median,
      ctB:t.p10,
      ctW:t.p90,
      scrap:0
    });
  });
};
</script>

</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>TaktLab – Cycle Time & Capacity Analyzer</title>

<style>
:root{
  --bg-main:#07152b;
  --bg-card:#0b1f3a;
  --bg-card-soft:#0f2544;
  --accent-green:#00c853;
  --accent-amber:#ffb300;
  --accent-red:#ff1744;
  --accent-blue:#29b6f6;
  --text-main:#ffffff;
  --text-soft:#c5cae9;
  --text-muted:#90a4ae;
  --border-soft:#1c3357;
}
*{box-sizing:border-box;}
body{
  margin:0;
  font-family:system-ui,sans-serif;
  background:linear-gradient(180deg,#020b1a,#07152b,#020b1a);
  color:var(--text-main);
}
.page{max-width:1100px;margin:0 auto;padding:12px 10px 40px;}

.tabs{display:flex;gap:8px;margin:6px 0 10px;}
.tab-btn{
  padding:8px 14px;border-radius:999px;
  border:1px solid var(--border-soft);
  background:#020b1a;color:var(--text-soft);
  font-weight:700;cursor:pointer;
}
.tab-btn.active{background:var(--accent-blue);color:#fff;}
.tab-panel{display:none;}
.tab-panel.active{display:block;}

.section-card{
  background:var(--bg-card);
  border-radius:18px;border:1px solid var(--border-soft);
  padding:12px;margin-bottom:10px;
}
.section-title{font-size:.9rem;font-weight:700;margin-bottom:6px;}

.wb-controls{display:flex;gap:8px;margin-bottom:8px;flex-wrap:wrap;}
.wb-controls button, .wb-controls select{
  padding:8px 12px;border-radius:14px;
  border:none;font-weight:700;cursor:pointer;
}
.btn-add{background:var(--accent-green);color:#000;}
.btn-load{background:var(--accent-amber);color:#000;}
.btn-reset{background:var(--accent-red);color:#fff;}
.wb-controls select{
  background:#020b1a;color:var(--text-soft);
  border:1px solid var(--border-soft);
}

.wb-kpis{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:10px;margin-bottom:10px;
}
.wb-kpi{
  background:var(--bg-card-soft);
  border:1px solid var(--border-soft);
  border-radius:14px;padding:10px;
}
.wb-kpi .label{font-size:.7rem;color:var(--text-muted);}
.wb-kpi .value{font-size:1.05rem;font-weight:800;}

table{width:100%;border-collapse:collapse;font-size:.75rem;}
th,td{
  padding:6px 8px;
  border-bottom:1px solid rgba(255,255,255,.05);
  text-align:right;
}
th:first-child,td:first-child{text-align:left;}
input{
  background:#020b1a;border:1px solid var(--border-soft);
  border-radius:8px;padding:4px 6px;
  color:var(--text-soft);font-size:.74rem;
  width:90px;text-align:right;
}
input.name{width:140px;text-align:left;}
.bottleneck{background:rgba(255,23,68,.18);}
</style>
</head>

<body>
<div class="page">

<div class="tabs">
  <button class="tab-btn active" id="tabTakt">TaktLab</button>
  <button class="tab-btn" id="tabWB">WB (Scenarios)</button>
</div>

<div class="tab-panel active" id="panelTakt">
  <div class="section-card">
    <div class="section-title">TaktLab</div>
    <div style="font-size:.8rem;color:var(--text-soft);">
      TaktLab engine running. Capture laps as usual.
    </div>
  </div>
</div>

<div class="tab-panel" id="panelWB">
  <div class="section-card">
    <div class="section-title">WB – Scenario Builder</div>

    <div class="wb-controls">
      <button class="btn-add" id="wbAdd">+ Add Operation</button>
      <button class="btn-load" id="wbLoad">Load from TaktLab</button>
      <button class="btn-reset" id="wbReset">Reset WB</button>

      <select id="wbScenario">
        <option value="A">Scenario: Actual</option>
        <option value="B">Scenario: Best</option>
        <option value="W">Scenario: Worst</option>
      </select>
    </div>

    <div class="wb-kpis">
      <div class="wb-kpi">
        <div class="label">Line Capacity (units/day)</div>
        <div class="value" id="wbOut">—</div>
      </div>
      <div class="wb-kpi">
        <div class="label">Bottleneck Operation</div>
        <div class="value" id="wbBottle">—</div>
      </div>
      <div class="wb-kpi">
        <div class="label">Rolled Scrap (%)</div>
        <div class="value" id="wbScrap">—</div>
      </div>
      <div class="wb-kpi">
        <div class="label">Input Required (units/day)</div>
        <div class="value" id="wbInput">—</div>
      </div>
    </div>

    <table>
      <thead>
        <tr>
          <th>Operation</th>
          <th>#Machines</th>
          <th>CT Actual</th>
          <th>CT Best</th>
          <th>CT Worst</th>
          <th>Scrap %</th>
          <th>Cap / Day</th>
        </tr>
      </thead>
      <tbody id="wbBody"></tbody>
    </table>
  </div>
</div>

</div>

<script>
/* Tabs */
const tabTakt=document.getElementById('tabTakt');
const tabWB=document.getElementById('tabWB');
const panelTakt=document.getElementById('panelTakt');
const panelWB=document.getElementById('panelWB');
tabTakt.onclick=()=>{tabTakt.classList.add('active');tabWB.classList.remove('active');panelTakt.classList.add('active');panelWB.classList.remove('active');};
tabWB.onclick=()=>{tabWB.classList.add('active');tabTakt.classList.remove('active');panelWB.classList.add('active');panelTakt.classList.remove('active');};

/* Mock TaktLab Stats */
let taktStats=[
  {process:'Op 10', median:45, p10:40, p90:55},
  {process:'Op 20', median:52, p10:48, p90:65},
  {process:'Op 30', median:60, p10:55, p90:72}
];

const HOURS_PER_DAY=8;
let wbRows=[];
let scenario='A';

function addWBRow(d){
  wbRows.push({
    name:d?.name||'New Op',
    machines:d?.machines||1,
    ctA:d?.ctA||0,
    ctB:d?.ctB||0,
    ctW:d?.ctW||0,
    scrap:d?.scrap||0
  });
  renderWB();
}

function getCT(r){
  if(scenario==='B') return r.ctB;
  if(scenario==='W') return r.ctW;
  return r.ctA;
}

function calcRolledScrap(){
  let good=1;
  wbRows.forEach(r=>{
    const s=Math.max(0,Math.min(r.scrap,100))/100;
    good*=(1-s);
  });
  return 1-good;
}

function renderWB(){
  const body=document.getElementById('wbBody');
  body.innerHTML='';
  let lineCap=Infinity,bottle='—';

  wbRows.forEach((r,i)=>{
    const ct=getCT(r);
    const ctEff=ct>0?ct/r.machines:0;
    const capDay=ctEff>0?(3600/ctEff)*HOURS_PER_DAY:0;

    if(capDay>0 && capDay<lineCap){
      lineCap=capDay;
      bottle=r.name;
    }

    const tr=document.createElement('tr');
    tr.className=(bottle===r.name)?'bottleneck':'';
    tr.innerHTML=`
      <td><input class="name" value="${r.name}" onchange="wbRows[${i}].name=this.value;renderWB()"></td>
      <td><input type="number" min="1" value="${r.machines}" onchange="wbRows[${i}].machines=+this.value;renderWB()"></td>
      <td><input type="number" value="${r.ctA}" onchange="wbRows[${i}].ctA=+this.value;renderWB()"></td>
      <td><input type="number" value="${r.ctB}" onchange="wbRows[${i}].ctB=+this.value;renderWB()"></td>
      <td><input type="number" value="${r.ctW}" onchange="wbRows[${i}].ctW=+this.value;renderWB()"></td>
      <td><input type="number" value="${r.scrap}" onchange="wbRows[${i}].scrap=+this.value;renderWB()"></td>
      <td>${capDay?capDay.toFixed(0):'—'}</td>
    `;
    body.appendChild(tr);
  });

  if(!isFinite(lineCap)) lineCap=0;
  const rolled=calcRolledScrap();
  const input=lineCap>0?lineCap/(1-rolled):0;

  document.getElementById('wbOut').textContent=lineCap?lineCap.toFixed(0):'—';
  document.getElementById('wbBottle').textContent=bottle;
  document.getElementById('wbScrap').textContent=(rolled*100).toFixed(1)+'%';
  document.getElementById('wbInput').textContent=input?input.toFixed(0):'—';
}

/* Buttons */
document.getElementById('wbAdd').onclick=()=>addWBRow();
document.getElementById('wbReset').onclick=()=>{wbRows=[];renderWB();};
document.getElementById('wbLoad').onclick=()=>{
  wbRows=[];
  taktStats.forEach(t=>addWBRow({
    name:t.process,machines:1,
    ctA:t.median,ctB:t.p10,ctW:t.p90,scrap:0
  }));
};
document.getElementById('wbScenario').onchange=e=>{
  scenario=e.target.value;
  renderWB();
};
</script>

</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>TaktLab – Cycle Time & Capacity Analyzer</title>

<style>
:root{
  --bg-main:#07152b;
  --bg-card:#0b1f3a;
  --bg-card-soft:#0f2544;
  --accent-green:#00c853;
  --accent-amber:#ffb300;
  --accent-red:#ff1744;
  --accent-blue:#29b6f6;
  --text-main:#ffffff;
  --text-soft:#c5cae9;
  --text-muted:#90a4ae;
  --border-soft:#1c3357;
}
*{box-sizing:border-box;}
body{
  margin:0;
  font-family:system-ui,sans-serif;
  background:linear-gradient(180deg,#020b1a,#07152b,#020b1a);
  color:var(--text-main);
}
.page{max-width:1100px;margin:0 auto;padding:12px 10px 40px;}

.tabs{display:flex;gap:8px;margin:6px 0 10px;}
.tab-btn{
  padding:8px 14px;border-radius:999px;
  border:1px solid var(--border-soft);
  background:#020b1a;color:var(--text-soft);
  font-weight:700;cursor:pointer;
}
.tab-btn.active{background:var(--accent-blue);color:#fff;}
.tab-panel{display:none;}
.tab-panel.active{display:block;}

.section-card{
  background:var(--bg-card);
  border-radius:18px;border:1px solid var(--border-soft);
  padding:12px;margin-bottom:10px;
}
.section-title{font-size:.9rem;font-weight:700;margin-bottom:6px;}

.wb-controls{display:flex;gap:8px;margin-bottom:8px;flex-wrap:wrap;}
.wb-controls button, .wb-controls select{
  padding:8px 12px;border-radius:14px;
  border:none;font-weight:700;cursor:pointer;
}
.btn-add{background:var(--accent-green);color:#000;}
.btn-load{background:var(--accent-amber);color:#000;}
.btn-reset{background:var(--accent-red);color:#fff;}
.wb-controls select{
  background:#020b1a;color:var(--text-soft);
  border:1px solid var(--border-soft);
}

.wb-kpis{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:10px;margin-bottom:10px;
}
.wb-kpi{
  background:var(--bg-card-soft);
  border:1px solid var(--border-soft);
  border-radius:14px;padding:10px;
}
.wb-kpi .label{font-size:.7rem;color:var(--text-muted);}
.wb-kpi .value{font-size:1.05rem;font-weight:800;}

table{width:100%;border-collapse:collapse;font-size:.72rem;}
th,td{
  padding:6px 6px;
  border-bottom:1px solid rgba(255,255,255,.05);
  text-align:right;
}
th:first-child,td:first-child{text-align:left;}
input{
  background:#020b1a;border:1px solid var(--border-soft);
  border-radius:8px;padding:4px 6px;
  color:var(--text-soft);font-size:.72rem;
  width:80px;text-align:right;
}
input.name{width:120px;text-align:left;}
.bottleneck{background:rgba(255,23,68,.18);}
</style>
</head>

<body>
<div class="page">

<div class="tabs">
  <button class="tab-btn active" id="tabTakt">TaktLab</button>
  <button class="tab-btn" id="tabWB">WB (Scenarios)</button>
</div>

<div class="tab-panel active" id="panelTakt">
  <div class="section-card">
    <div class="section-title">TaktLab</div>
    <div style="font-size:.8rem;color:var(--text-soft);">
      TaktLab engine running.
    </div>
  </div>
</div>

<div class="tab-panel" id="panelWB">
  <div class="section-card">
    <div class="section-title">WB – Scenario Builder</div>

    <div class="wb-controls">
      <button class="btn-add" id="wbAdd">+ Add Operation</button>
      <button class="btn-load" id="wbLoad">Load from TaktLab</button>
      <button class="btn-reset" id="wbReset">Reset WB</button>
      <select id="wbScenario">
        <option value="A">Scenario: Actual</option>
        <option value="B">Scenario: Best</option>
        <option value="W">Scenario: Worst</option>
      </select>
    </div>

    <div class="wb-kpis">
      <div class="wb-kpi"><div class="label">Line Capacity (units/day)</div><div class="value" id="wbOut">—</div></div>
      <div class="wb-kpi"><div class="label">Bottleneck</div><div class="value" id="wbBottle">—</div></div>
      <div class="wb-kpi"><div class="label">Rolled Scrap</div><div class="value" id="wbScrap">—</div></div>
      <div class="wb-kpi"><div class="label">Input Required</div><div class="value" id="wbInput">—</div></div>
    </div>

    <table>
      <thead>
        <tr>
          <th>Operation</th>
          <th>#M</th>
          <th>CT A</th>
          <th>CT B</th>
          <th>CT W</th>
          <th>Scrap %</th>
          <th>Launch</th>
          <th>CO</th>
          <th>PM</th>
          <th>CM</th>
          <th>Other</th>
          <th>Cap / Day</th>
        </tr>
      </thead>
      <tbody id="wbBody"></tbody>
    </table>
  </div>
</div>

</div>

<script>
const HOURS_PER_DAY=8;
let scenario='A';

let taktStats=[
  {process:'Op 10', median:45, p10:40, p90:55},
  {process:'Op 20', median:52, p10:48, p90:65},
  {process:'Op 30', median:60, p10:55, p90:72}
];

let wbRows=[];

/* Tabs */
const tabTakt=document.getElementById('tabTakt');
const tabWB=document.getElementById('tabWB');
const panelTakt=document.getElementById('panelTakt');
const panelWB=document.getElementById('panelWB');
tabTakt.onclick=()=>{tabTakt.classList.add('active');tabWB.classList.remove('active');panelTakt.classList.add('active');panelWB.classList.remove('active');};
tabWB.onclick=()=>{tabWB.classList.add('active');tabTakt.classList.remove('active');panelWB.classList.add('active');panelTakt.classList.remove('active');};

function getCT(r){
  if(scenario==='B') return r.ctB;
  if(scenario==='W') return r.ctW;
  return r.ctA;
}

function addWBRow(d){
  wbRows.push({
    name:d?.name||'New Op',
    machines:d?.machines||1,
    ctA:d?.ctA||0,
    ctB:d?.ctB||0,
    ctW:d?.ctW||0,
    scrap:d?.scrap||0,
    launch:0,co:0,pm:0,cm:0,other:0
  });
  renderWB();
}

function calcRolledScrap(){
  let good=1;
  wbRows.forEach(r=>{
    const s=Math.max(0,Math.min(r.scrap,100))/100;
    good*=(1-s);
  });
  return 1-good;
}

function renderWB(){
  const body=document.getElementById('wbBody');
  body.innerHTML='';
  let lineCap=Infinity,bottle='—';

  wbRows.forEach((r,i)=>{
    const ct=getCT(r);
    const lostMin=r.launch+r.co+r.pm+r.cm+r.other;
    const availSec=Math.max(0,(HOURS_PER_DAY*3600)-(lostMin*60));
    const cap=ct>0?(availSec/ct)*r.machines:0;

    if(cap>0 && cap<lineCap){
      lineCap=cap;
      bottle=r.name;
    }

    const tr=document.createElement('tr');
    tr.className=(bottle===r.name)?'bottleneck':'';
    tr.innerHTML=`
      <td><input class="name" value="${r.name}" onchange="wbRows[${i}].name=this.value;renderWB()"></td>
      <td><input type="number" value="${r.machines}" min="1" onchange="wbRows[${i}].machines=+this.value;renderWB()"></td>
      <td><input type="number" value="${r.ctA}" onchange="wbRows[${i}].ctA=+this.value;renderWB()"></td>
      <td><input type="number" value="${r.ctB}" onchange="wbRows[${i}].ctB=+this.value;renderWB()"></td>
      <td><input type="number" value="${r.ctW}" onchange="wbRows[${i}].ctW=+this.value;renderWB()"></td>
      <td><input type="number" value="${r.scrap}" onchange="wbRows[${i}].scrap=+this.value;renderWB()"></td>
      <td><input type="number" value="${r.launch}" onchange="wbRows[${i}].launch=+this.value;renderWB()"></td>
      <td><input type="number" value="${r.co}" onchange="wbRows[${i}].co=+this.value;renderWB()"></td>
      <td><input type="number" value="${r.pm}" onchange="wbRows[${i}].pm=+this.value;renderWB()"></td>
      <td><input type="number" value="${r.cm}" onchange="wbRows[${i}].cm=+this.value;renderWB()"></td>
      <td><input type="number" value="${r.other}" onchange="wbRows[${i}].other=+this.value;renderWB()"></td>
      <td>${cap?cap.toFixed(0):'—'}</td>
    `;
    body.appendChild(tr);
  });

  if(!isFinite(lineCap)) lineCap=0;
  const rolled=calcRolledScrap();
  const input=lineCap>0?lineCap/(1-rolled):0;

  document.getElementById('wbOut').textContent=lineCap?lineCap.toFixed(0):'—';
  document.getElementById('wbBottle').textContent=bottle;
  document.getElementById('wbScrap').textContent=(rolled*100).toFixed(1)+'%';
  document.getElementById('wbInput').textContent=input?input.toFixed(0):'—';
}

/* Buttons */
document.getElementById('wbAdd').onclick=()=>addWBRow();
document.getElementById('wbReset').onclick=()=>{wbRows=[];renderWB();};
document.getElementById('wbLoad').onclick=()=>{
  wbRows=[];
  taktStats.forEach(t=>addWBRow({
    name:t.process,machines:1,
    ctA:t.median,ctB:t.p10,ctW:t.p90,scrap:0
  }));
};
document.getElementById('wbScenario').onchange=e=>{
  scenario=e.target.value;
  renderWB();
};
</script>

</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>TaktLab – Cycle Time & Capacity Analyzer</title>

<style>
:root{
  --bg-main:#07152b;
  --bg-card:#0b1f3a;
  --bg-card-soft:#0f2544;
  --accent-green:#00c853;
  --accent-amber:#ffb300;
  --accent-red:#ff1744;
  --accent-blue:#29b6f6;
  --text-main:#ffffff;
  --text-soft:#c5cae9;
  --text-muted:#90a4ae;
  --border-soft:#1c3357;
}
*{box-sizing:border-box;}
body{
  margin:0;
  font-family:system-ui,sans-serif;
  background:linear-gradient(180deg,#020b1a,#07152b,#020b1a);
  color:var(--text-main);
}
.page{max-width:1200px;margin:0 auto;padding:12px 10px 40px;}

.tabs{display:flex;gap:8px;margin:6px 0 10px;}
.tab-btn{
  padding:8px 14px;border-radius:999px;
  border:1px solid var(--border-soft);
  background:#020b1a;color:var(--text-soft);
  font-weight:700;cursor:pointer;
}
.tab-btn.active{background:var(--accent-blue);color:#fff;}
.tab-panel{display:none;}
.tab-panel.active{display:block;}

.section-card{
  background:var(--bg-card);
  border-radius:18px;border:1px solid var(--border-soft);
  padding:12px;margin-bottom:10px;
}
.section-title{font-size:.95rem;font-weight:800;margin-bottom:6px;}

.wb-controls{display:flex;gap:8px;margin-bottom:8px;flex-wrap:wrap;}
.wb-controls button, .wb-controls select{
  padding:8px 12px;border-radius:14px;
  border:none;font-weight:700;cursor:pointer;
}
.btn-add{background:var(--accent-green);color:#000;}
.btn-load{background:var(--accent-amber);color:#000;}
.btn-reset{background:var(--accent-red);color:#fff;}
.btn-export{background:var(--accent-blue);color:#000;}
.wb-controls select{
  background:#020b1a;color:var(--text-soft);
  border:1px solid var(--border-soft);
}

.wb-kpis{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:10px;margin-bottom:10px;
}
.wb-kpi{
  background:var(--bg-card-soft);
  border:1px solid var(--border-soft);
  border-radius:14px;padding:10px;
}
.wb-kpi .label{font-size:.7rem;color:var(--text-muted);}
.wb-kpi .value{font-size:1.1rem;font-weight:900;}

table{width:100%;border-collapse:collapse;font-size:.72rem;}
th,td{
  padding:6px 6px;
  border-bottom:1px solid rgba(255,255,255,.05);
  text-align:right;
}
th:first-child,td:first-child{text-align:left;}
input{
  background:#020b1a;border:1px solid var(--border-soft);
  border-radius:8px;padding:4px 6px;
  color:var(--text-soft);font-size:.72rem;
  width:80px;text-align:right;
}
input.name{width:120px;text-align:left;}
.bottleneck{background:rgba(255,23,68,.18);}

.method{
  font-size:.75rem;
  line-height:1.35;
  color:var(--text-soft);
}
.method ul{margin:6px 0 6px 18px;padding:0;}
.method li{margin-bottom:4px;}
</style>
</head>

<body>
<div class="page">

<div class="tabs">
  <button class="tab-btn active" id="tabTakt">TaktLab</button>
  <button class="tab-btn" id="tabWB">WB (Scenarios)</button>
</div>

<div class="tab-panel active" id="panelTakt">
  <div class="section-card">
    <div class="section-title">TaktLab</div>
    <div style="font-size:.8rem;color:var(--text-soft);">
      Measurement engine ready. Capture cycle times as usual.
    </div>
  </div>
</div>

<div class="tab-panel" id="panelWB">
  <div class="section-card">
    <div class="section-title">WB – Scenario Builder</div>

    <div class="wb-controls">
      <button class="btn-add" id="wbAdd">+ Add Operation</button>
      <button class="btn-load" id="wbLoad">Load from TaktLab</button>
      <button class="btn-reset" id="wbReset">Reset WB</button>
      <button class="btn-export" id="wbExport">Export WB</button>
      <select id="wbScenario">
        <option value="A">Scenario: Actual</option>
        <option value="B">Scenario: Best</option>
        <option value="W">Scenario: Worst</option>
      </select>
    </div>

    <div class="wb-kpis">
      <div class="wb-kpi"><div class="label">Line Capacity</div><div class="value" id="wbOut">—</div></div>
      <div class="wb-kpi"><div class="label">Bottleneck</div><div class="value" id="wbBottle">—</div></div>
      <div class="wb-kpi"><div class="label">Rolled Scrap</div><div class="value" id="wbScrap">—</div></div>
      <div class="wb-kpi"><div class="label">Input Required</div><div class="value" id="wbInput">—</div></div>
    </div>

    <table>
      <thead>
        <tr>
          <th>Operation</th>
          <th>#M</th>
          <th>CT A</th>
          <th>CT B</th>
          <th>CT W</th>
          <th>Scrap %</th>
          <th>Launch</th>
          <th>CO</th>
          <th>PM</th>
          <th>CM</th>
          <th>Other</th>
          <th>Cap/Day</th>
        </tr>
      </thead>
      <tbody id="wbBody"></tbody>
    </table>
  </div>

  <div class="section-card">
    <div class="section-title">Statistical Approach & Methodology</div>
    <div class="method">
      <ul>
        <li><b>CT Actual</b> represents the Median (P50) of measured cycle times.</li>
        <li><b>CT Best</b> uses P10, reflecting a stable best-case execution.</li>
        <li><b>CT Worst</b> uses P90, representing high-variability conditions.</li>
        <li>Scenario capacity is calculated using available time after planned and unplanned losses.</li>
        <li><b>Rolled Scrap</b> is calculated as: <i>1 − Π(1 − scrapᵢ)</i>.</li>
        <li><b>Input Required</b> compensates scrap losses to achieve final output.</li>
        <li>The line bottleneck is defined as the operation with the minimum effective capacity.</li>
      </ul>
      This model allows evaluating current performance, risk exposure, and improvement potential across the full production line.
    </div>
  </div>
</div>

</div>

<script>
const HOURS_PER_DAY=8;
let scenario='A';

let taktStats=[
  {process:'Op 10', median:45, p10:40, p90:55},
  {process:'Op 20', median:52, p10:48, p90:65},
  {process:'Op 30', median:60, p10:55, p90:72}
];

let wbRows=[];

/* Tabs */
const tabTakt=document.getElementById('tabTakt');
const tabWB=document.getElementById('tabWB');
const panelTakt=document.getElementById('panelTakt');
const panelWB=document.getElementById('panelWB');
tabTakt.onclick=()=>{tabTakt.classList.add('active');tabWB.classList.remove('active');panelTakt.classList.add('active');panelWB.classList.remove('active');};
tabWB.onclick=()=>{tabWB.classList.add('active');tabTakt.classList.remove('active');panelWB.classList.add('active');panelTakt.classList.remove('active');};

function getCT(r){
  if(scenario==='B') return r.ctB;
  if(scenario==='W') return r.ctW;
  return r.ctA;
}

function addWBRow(d){
  wbRows.push({
    name:d?.name||'New Op',
    machines:d?.machines||1,
    ctA:d?.ctA||0,
    ctB:d?.ctB||0,
    ctW:d?.ctW||0,
    scrap:d?.scrap||0,
    launch:0,co:0,pm:0,cm:0,other:0
  });
  renderWB();
}

function calcRolledScrap(){
  let good=1;
  wbRows.forEach(r=>{
    const s=Math.max(0,Math.min(r.scrap,100))/100;
    good*=(1-s);
  });
  return 1-good;
}

function renderWB(){
  const body=document.getElementById('wbBody');
  body.innerHTML='';
  let lineCap=Infinity,bottle='—';

  wbRows.forEach((r,i)=>{
    const ct=getCT(r);
    const lostMin=r.launch+r.co+r.pm+r.cm+r.other;
    const availSec=Math.max(0,(HOURS_PER_DAY*3600)-(lostMin*60));
    const cap=ct>0?(availSec/ct)*r.machines:0;

    if(cap>0 && cap<lineCap){
      lineCap=cap;
      bottle=r.name;
    }

    const tr=document.createElement('tr');
    tr.className=(bottle===r.name)?'bottleneck':'';
    tr.innerHTML=`
      <td><input class="name" value="${r.name}" onchange="wbRows[${i}].name=this.value;renderWB()"></td>
      <td><input type="number" value="${r.machines}" onchange="wbRows[${i}].machines=+this.value;renderWB()"></td>
      <td><input type="number" value="${r.ctA}" onchange="wbRows[${i}].ctA=+this.value;renderWB()"></td>
      <td><input type="number" value="${r.ctB}" onchange="wbRows[${i}].ctB=+this.value;renderWB()"></td>
      <td><input type="number" value="${r.ctW}" onchange="wbRows[${i}].ctW=+this.value;renderWB()"></td>
      <td><input type="number" value="${r.scrap}" onchange="wbRows[${i}].scrap=+this.value;renderWB()"></td>
      <td><input type="number" value="${r.launch}" onchange="wbRows[${i}].launch=+this.value;renderWB()"></td>
      <td><input type="number" value="${r.co}" onchange="wbRows[${i}].co=+this.value;renderWB()"></td>
      <td><input type="number" value="${r.pm}" onchange="wbRows[${i}].pm=+this.value;renderWB()"></td>
      <td><input type="number" value="${r.cm}" onchange="wbRows[${i}].cm=+this.value;renderWB()"></td>
      <td><input type="number" value="${r.other}" onchange="wbRows[${i}].other=+this.value;renderWB()"></td>
      <td>${cap?cap.toFixed(0):'—'}</td>
    `;
    body.appendChild(tr);
  });

  if(!isFinite(lineCap)) lineCap=0;
  const rolled=calcRolledScrap();
  const input=lineCap>0?lineCap/(1-rolled):0;

  document.getElementById('wbOut').textContent=lineCap?lineCap.toFixed(0):'—';
  document.getElementById('wbBottle').textContent=bottle;
  document.getElementById('wbScrap').textContent=(rolled*100).toFixed(1)+'%';
  document.getElementById('wbInput').textContent=input?input.toFixed(0):'—';
}

/* Buttons */
document.getElementById('wbAdd').onclick=()=>addWBRow();
document.getElementById('wbReset').onclick=()=>{wbRows=[];renderWB();};
document.getElementById('wbLoad').onclick=()=>{
  wbRows=[];
  taktStats.forEach(t=>addWBRow({
    name:t.process,machines:1,
    ctA:t.median,ctB:t.p10,ctW:t.p90,scrap:0
  }));
};
document.getElementById('wbScenario').onchange=e=>{
  scenario=e.target.value;
  renderWB();
};
document.getElementById('wbExport').onclick=()=>{
  let csv='Operation,Machines,CT_A,CT_B,CT_W,Scrap,Launch,CO,PM,CM,Other,Cap\n';
  wbRows.forEach(r=>{
    csv+=`${r.name},${r.machines},${r.ctA},${r.ctB},${r.ctW},${r.scrap},${r.launch},${r.co},${r.pm},${r.cm},${r.other}\n`;
  });
  const blob=new Blob([csv],{type:'text/csv'});
  const a=document.createElement('a');
  a.href=URL.createObjectURL(blob);
  a.download='WB_Scenario.csv';
  a.click();
};
</script>

</body>
</html>
